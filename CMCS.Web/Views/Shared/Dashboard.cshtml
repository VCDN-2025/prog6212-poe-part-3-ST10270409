@model List<CMCS.Web.Models.Claim>
@{
    ViewData["Title"] = "HR Dashboard";
    var totalPayments = ViewBag.TotalPayments as decimal? ?? 0m;
    var pendingClaims = ViewBag.PendingClaims as int? ?? 0;
    var verifiedClaims = ViewBag.VerifiedClaims as int? ?? 0;
    var totalLecturers = ViewBag.TotalLecturers as int? ?? 0;
}

<h2 class="mb-4">HR Dashboard</h2>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <h5 class="card-title">Total Payments</h5>
                <h3 class="card-text">R @totalPayments.ToString("N2")</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-warning">
            <div class="card-body">
                <h5 class="card-title">Pending Claims</h5>
                <h3 class="card-text">@pendingClaims</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-info">
            <div class="card-body">
                <h5 class="card-title">Verified Claims</h5>
                <h3 class="card-text">@verifiedClaims</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-success">
            <div class="card-body">
                <h5 class="card-title">Total Lecturers</h5>
                <h3 class="card-text">@totalLecturers</h3>
            </div>
        </div>
    </div>
</div>

<div class="d-flex gap-2 mb-3">
    <form asp-controller="HR" asp-action="GeneratePaymentReport" method="post" class="d-inline">
        @Html.AntiForgeryToken()
        <button type="submit" class="btn btn-success">Generate Payment Report</button>
    </form>

    <a asp-controller="Account" asp-action="ManageUsers" class="btn btn-primary">Manage Users</a>
    <a asp-controller="Reports" asp-action="Index" class="btn btn-info">Advanced Reports</a>
</div>

<h4 class="mt-4">Recent Claims</h4>
@if (Model == null || !Model.Any())
{
    <div class="alert alert-info">No claims found.</div>
}
else
{
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Lecturer</th>
                <th>Date</th>
                <th>Hours</th>
                <th>Total (R)</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var claim in Model.Take(10))
            {
                <tr>
                    <td>@claim.LecturerName</td>
                    <td>@claim.Date.ToString("yyyy-MM-dd")</td>
                    <td>@claim.HoursWorked</td>
                    <td>@claim.Total.ToString("F2")</td>
                    <td>
                        <span class="badge @(claim.Status == CMCS.Web.Models.ClaimStatus.ApprovedByManager ? "bg-success" :
                                          claim.Status == CMCS.Web.Models.ClaimStatus.VerifiedByCoordinator ? "bg-info" :
                                          claim.Status == CMCS.Web.Models.ClaimStatus.Pending ? "bg-warning" : "bg-danger")">
                            @claim.Status
                        </span>
                    </td>
                    <td>
                        @if (claim.Status == CMCS.Web.Models.ClaimStatus.ApprovedByManager)
                        {
                            <form asp-controller="HR" asp-action="GenerateInvoice" method="post" class="d-inline">
                                <input type="hidden" name="claimId" value="@claim.Id" />
                                @Html.AntiForgeryToken()
                                <button type="submit" class="btn btn-sm btn-outline-primary">Generate Invoice</button>
                            </form>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
}